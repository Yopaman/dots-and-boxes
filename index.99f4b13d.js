class e{constructor(e,t){this.board=[],this.height=t,this.width=e;for(let s=0;s<t;s++){let t=[];for(let s=0;s<e;s++)t.push({owner:null,linesOwners:{top:null,left:null,right:null,bottom:null}});this.board.push(t)}}setSquareOwner(e,t,s){this.board[t][e].owner=s}setLineOwner(e,t,s,r){switch(s){case"right":this.board[t][e].linesOwners.right=r,e<this.width-1&&(this.board[t][e+1].linesOwners.left=r);break;case"left":this.board[t][e].linesOwners.left=r,e>0&&(this.board[t][e-1].linesOwners.right=r);break;case"top":this.board[t][e].linesOwners.top=r,t>0&&(this.board[t-1][e].linesOwners.bottom=r);break;case"bottom":this.board[t][e].linesOwners.bottom=r,t<this.height-1&&(this.board[t+1][e].linesOwners.top=r)}}printBoard(){let e="";for(let t=0;t<this.height;t++){for(let t=0;t<this.width;t++)e+=0==t?"□ ":" □ ";e+="\n"}console.log(e)}}class t extends HTMLElement{connectedCallback(){document.querySelector(".replay-button").addEventListener("click",(()=>{this.replay()}))}constructor(){super();const e=document.createElement("div");e.classList.add("overlay"),e.classList.add("absolute","top-0","left-0","flex","h-screen","w-screen","bg-black","bg-opacity-50","backdrop-blur-lg","z-0");const t=document.createElement("div");t.classList.add("form-container"),t.classList.add("container","relative","flex","flex-col","justify-center","items-center","m-auto","w-full","sm:w-1/4","h-fit","sm:h-fit","p-5","bg-white","shadow-sm","rounded-md");const s=document.createElement("h1");s.classList.add("end-text");const r=document.createElement("button");r.classList.add("replay-button"),r.appendChild(document.createTextNode("Rejouer")),r.classList.add("h-10","w-2/4","mt-5","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","active:bg-blue-800","shadow-md","hover:shadow-lg"),t.appendChild(s),t.appendChild(r),e.appendChild(t),this.appendChild(e)}setWinner(e){const t=document.querySelector(".end-text");null==e?t.appendChild(document.createTextNode("Égalité")):t.appendChild(document.createTextNode("Victoire de "+e))}replay(){window.location.reload()}}class s extends HTMLElement{get board_height(){return this.hasAttribute("board-height")?parseInt(this.getAttribute("board-height")):10}get board_width(){return this.hasAttribute("board-width")?parseInt(this.getAttribute("board-width")):10}connectedCallback(){const e=document.getElementsByTagName("td");for(let s=0;s<e.length;s++)["left","right","top","bottom"].forEach((r=>{const a=e[s].querySelector(".hitbox-"+r);a.addEventListener("mouseenter",(()=>{this.interractLine(Array.from(e[s].parentNode.children).indexOf(e[s]),Array.from(e[s].parentNode.parentNode.children).indexOf(e[s].parentElement),r,"select",this.game.players[this.game.currentPlayer].color)})),a.addEventListener("mouseleave",(()=>{this.interractLine(Array.from(e[s].parentNode.children).indexOf(e[s]),Array.from(e[s].parentNode.parentNode.children).indexOf(e[s].parentElement),r,"reset")})),a.addEventListener("click",(()=>{const a=Array.from(e[s].parentNode.children).indexOf(e[s]),n=Array.from(e[s].parentNode.parentNode.children).indexOf(e[s].parentElement),l=this.game.players[this.game.currentPlayer];this.interractLine(a,n,r,"click",l.color);const o=this.game.playTurn(a,n,r);if(document.querySelector("game-infos").updateScore(),o!=[])for(let e=0;e<o.length;e++)this.setBgColor(o[e][0],o[e][1],l.color);if(this.game.isGameFinished()){const e=document.createElement("end-screen");document.querySelector(".app").appendChild(e),customElements.define("end-screen",t),t.prototype.setWinner(this.game.getWinner())}}))}))}constructor(){super();const e=document.createElement("tbody");for(let t=0;t<this.board_height;t++){const s=document.createElement("tr");for(let e=0;e<this.board_width;e++){const r=document.createElement("span");r.className="dot dot-top-right";const a=document.createElement("span");a.className=" dot dot-top-left";const n=document.createElement("span");n.className="dot dot-bottom-right";const l=document.createElement("span");l.className="dot dot-bottom-left";const o=document.createElement("td");o.className="square",o.appendChild(a),e==this.board_width-1&&o.appendChild(r),t==this.board_height-1&&o.appendChild(l),t==this.board_height-1&&e==this.board_width-1&&o.appendChild(n),["left","right","top","bottom"].forEach((e=>{const t=document.createElement("span");t.className="hitbox hitbox-"+e,o.appendChild(t)})),s.appendChild(o)}e.appendChild(s)}const t=document.createElement("table");t.appendChild(e),this.appendChild(t)}interractLine(e,t,s,r="select",a="none"){const n="select"==r?"selected":"clicked",l=this.getElementsByTagName("table")[0],o=l.rows[t].cells[e];if("click"==r&&o.className.includes("selected-"+s)&&o.classList.remove("selected-"+s),!o.className.includes("clicked-"+s)){switch(s){case"right":if(e<this.board_width-1){const s=l.rows[t].cells[e+1];"click"==r&&s.className.includes("selected-left")&&s.classList.remove("selected-left"),"reset"==r?["selected"].forEach((e=>s.classList.remove(e+"-left"))):s.classList.add(n+"-left"),"click"==r&&s.classList.add(a+"-left")}"reset"==r?["selected"].forEach((e=>o.classList.remove(e+"-right"))):o.classList.add(n+"-right");break;case"left":if(e>0){const s=l.rows[t].cells[e-1];"click"==r&&s.className.includes("selected-right")&&s.classList.remove("selected-right"),"reset"==r?["selected"].forEach((e=>s.classList.remove(e+"-right"))):s.classList.add(n+"-right"),"click"==r&&s.classList.add(a+"-right")}"reset"==r?["selected"].forEach((e=>o.classList.remove(e+"-left"))):o.classList.add(n+"-left");break;case"top":if(t>0){const s=l.rows[t-1].cells[e];"click"==r&&s.className.includes("selected-bottom")&&s.classList.remove("selected-bottom"),"reset"==r?["selected"].forEach((e=>s.classList.remove(e+"-bottom"))):s.classList.add(n+"-bottom"),"click"==r&&s.classList.add(a+"-bottom")}"reset"==r?["selected"].forEach((e=>o.classList.remove(e+"-top"))):o.classList.add(n+"-top");break;case"bottom":if(t<this.board_height-1){const s=l.rows[t+1].cells[e];"click"==r&&s.className.includes("selected-")&&s.classList.remove("selected-top"),"reset"==r?["selected"].forEach((e=>s.classList.remove(e+"-top"))):s.classList.add(n+"-top"),"click"==r&&s.classList.add(a+"-top")}"reset"==r?["selected"].forEach((e=>o.classList.remove(e+"-bottom"))):o.classList.add(n+"-bottom")}"click"==r&&o.classList.add(a+"-"+s)}}setBgColor(e,t,s){this.getElementsByTagName("table")[0].rows[t].cells[e].classList.add("background-"+s)}}class r{constructor(e,...t){this.board=e;const s=["blue","red"];this.players=[];let r=0;t.map((e=>{this.players.push({name:e,score:0,color:s[r]}),r++})),this.currentPlayer=0}isLinePlayed(e,t,s){return null!=this.board.board[t][e].linesOwners[s]}playLine(e,t,s,r){this.board.setLineOwner(e,t,s,r)}nextPlayer(){this.currentPlayer!=this.players.length-1?this.currentPlayer++:this.currentPlayer=0}isSquareFull(e){return null!=e.linesOwners.left&&null!=e.linesOwners.top&&null!=e.linesOwners.right&&null!=e.linesOwners.bottom}isGameFinished(){const e=this.board.width*this.board.height;let t=0;for(let e=0;e<this.board.height;e++)for(let s=0;s<this.board.width;s++){if(null==this.board.board[e][s].owner)return!1;t++}return t==e}getWinner(){return this.players[0].score>this.players[1].score?this.players[0].name:this.players[1].score>this.players[0].score?this.players[1].name:null}calculateBoxes(){let e=0,t=[];for(let s=0;s<this.board.height;s++)for(let r=0;r<this.board.width;r++)null==this.board.board[s][r].owner&&this.isSquareFull(this.board.board[s][r])&&(this.board.board[s][r].owner=this.players[this.currentPlayer].name,e++,t.push([r,s]));return{score:e,xy:t}}playTurn(e,t,s){if(this.isLinePlayed(e,t,s))return[];{this.playLine(e,t,s,this.players[this.currentPlayer].name);let r=this.calculateBoxes(),a=r.score;return a<=0?this.nextPlayer():this.players[this.currentPlayer].score+=a,r.xy}}}const a=(e,t)=>e.length>t?`${e.substring(0,t)}...`:e;class n extends HTMLElement{constructor(){super();const e=document.createElement("div");e.classList.add("game-infos-container"),e.classList.add("container","relative","sm:w-fit","w-full","p-5","pt-0","flex","flex-col","content-top","items-center","mx-auto","mt-10","bg-slate-200","rounded-md");const t=document.createElement("h1");t.classList.add("infos-title"),t.appendChild(document.createTextNode("Score :")),t.classList.add("text-2xl","font-bold","mt-3","mb-3");const s=document.createElement("span"),r=document.createElement("span");s.classList.add("score-1"),r.classList.add("score-2");const n=["mx-2"];s.classList.add(...n),r.classList.add(...n),s.innerHTML="<strong>"+a(this.game.players[0].name,8)+"</strong> : "+this.game.players[0].score.toString(),r.innerHTML="<strong>"+a(this.game.players[1].name,8)+"</strong> : "+this.game.players[1].score.toString(),e.appendChild(t);const l=document.createElement("div");l.classList.add("scores"),l.classList.add("w-1/2","sm:w-fit","flex","justify-between","mb-2"),l.appendChild(s),l.appendChild(r),e.appendChild(l);const o=document.createElement("span");o.classList.add("current-player"),o.innerHTML="Au tour de <strong>"+a(this.game.players[this.game.currentPlayer].name,8)+"</strong> de jouer",e.appendChild(o),this.appendChild(e)}updateScore(){const e=document.querySelector(".score-1"),t=document.querySelector(".score-2"),s=document.querySelector(".current-player");e.innerHTML="<strong>"+a(this.game.players[0].name,8)+"</strong> : "+this.game.players[0].score.toString(),t.innerHTML="<strong>"+a(this.game.players[1].name,8)+"</strong> : "+this.game.players[1].score.toString(),s.innerHTML="Au tour de <strong>"+a(this.game.players[this.game.currentPlayer].name,8)+"</strong> de jouer"}}class l extends HTMLElement{connectedCallback(){document.querySelector(".validate-button").addEventListener("click",(()=>{this.createGame()}))}constructor(){super();const e=document.createElement("div");e.classList.add("overlay"),e.classList.add("flex","h-screen","w-screen","bg-black","bg-opacity-50","backdrop-blur-lg","z-0");const t=document.createElement("div");t.classList.add("form-container"),t.classList.add("container","relative","flex","flex-col","justify-center","items-center","m-auto","w-full","sm:w-1/2","h-2/5","sm:h-1/2","bg-white","shadow-sm","rounded-md");const s=document.createElement("h1");s.classList.add("creation-title"),s.appendChild(document.createTextNode("Créer une partie")),s.classList.add("text-3xl","font-bold","absolute","top-3");const r=document.createElement("input");r.classList.add("player1-input"),r.setAttribute("value","Joueur 1"),r.classList.add("pl-1","border","rounded-md","text-slate-600","border-slate-300","h-10","shadow-sm","w-1/2","mr-2");const a=document.createElement("input");a.classList.add("player2-input"),a.setAttribute("value","Joueur 2"),a.classList.add("pl-1","border","rounded-md","text-slate-600","border-slate-300","h-10","shadow-sm","w-1/2","ml-2");const n=document.createElement("button");n.classList.add("validate-button"),n.appendChild(document.createTextNode("Valider")),n.classList.add("absolute","bottom-5","h-10","w-2/4","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","active:bg-blue-800","shadow-md","hover:shadow-lg");const l=document.createElement("div");l.classList.add("inputs-container"),l.appendChild(r),l.appendChild(a),l.classList.add("w-3/4","mb-5","flex","flex-row","justify-between");const o=document.createElement("label");o.appendChild(document.createTextNode("Taille de la grille :"));const d=document.createElement("input");d.classList.add("size-input"),d.setAttribute("type","number"),d.setAttribute("value","5"),d.setAttribute("min","4"),d.setAttribute("max","20"),d.classList.add("h-10","w-1/4","border","rounded-md","border-slate-300","pl-1","text-slate-600","mb-5"),t.appendChild(s),t.appendChild(l),t.appendChild(o),t.appendChild(d),t.appendChild(n),e.appendChild(t),this.appendChild(e)}createGame(){const t=document.querySelector(".size-input"),a=parseInt(t.value),l=new e(a,a),o=document.querySelector(".player1-input").value,d=document.querySelector(".player2-input").value;document.querySelector(".overlay").style.display="none";const i=document.createElement("game-board");i.setAttribute("board-width",a.toString()),i.setAttribute("board-height",a.toString()),document.querySelector(".app").appendChild(i),customElements.define("game-board",s);const c=new r(l,o,d);s.prototype.game=c,n.prototype.game=c;const h=document.createElement("game-infos");customElements.define("game-infos",n),document.querySelector(".app").appendChild(h)}}customElements.define("game-creation",l);
//# sourceMappingURL=index.99f4b13d.js.map
